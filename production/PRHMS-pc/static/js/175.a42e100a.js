"use strict";(self["webpackChunkpc_web"]=self["webpackChunkpc_web"]||[]).push([[175],{175:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[t._m(0),e("div",{staticClass:"table-container"},[e("div",{staticClass:"fl"},[e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(13)}}},[e("span",[t._v("13 层")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(12)}}},[e("span",[t._v("12 层")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(11)}}},[e("span",[t._v("11 层")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(10)}}},[e("span",[t._v("10 层")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(9)}}},[e("span",[t._v("9 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(8)}}},[e("span",[t._v("8 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(7)}}},[e("span",[t._v("7 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(6)}}},[e("span",[t._v("6 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(5)}}},[e("span",[t._v("5 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(4)}}},[e("span",[t._v("4 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(3)}}},[e("span",[t._v("3 层 ")])]),e("div",{staticClass:"floor",on:{click:function(e){return t.goFloor(2)}}},[e("span",[t._v("2 层 ")])]),e("div",{staticClass:"door"}),e("div",{staticClass:"ps"},[t._v("*六层以上为高楼层")])]),e("div",{staticClass:"fr"},[1==t.isCurrent?[e("div",{staticClass:"fr-index"},[t._m(1),e("div",{staticClass:"card"},[e("el-row",t._l(t.houseNum,(function(s,r){return e("el-col",{key:r,attrs:{span:6}},[e("div",{staticClass:"statistic"},[e("el-statistic",{attrs:{title:`${s.floorId}层`}},[e("template",{slot:"formatter"},[t._v(" "+t._s(s.allNum)+"/"+t._s(s.peaceNum)+" ")])],2)],1)])})),1)],1)])]:[e("div",{staticClass:"fr-floor"},[e("el-page-header",{attrs:{content:t.title},on:{back:t.getAll}}),e("div",{staticClass:"floor-container"},[e("div",{staticClass:"navbar"},[e("el-row",{attrs:{justify:"space-around"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"area"},[t._v("总 面 积 : "+t._s(t.area)+" (㎡)")]),e("span",{staticClass:"area",staticStyle:{color:"#00d0b5"}},[t._v(" 可 用 面 积 : "+t._s(t.available)+" (㎡)")])]),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[e("el-button",{staticClass:"add",attrs:{disabled:t.isAdd},on:{click:function(e){return t.add()}}},[t._v("添 加 +")])],1)],1)],1),e("div",{staticClass:"table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"472"},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":200}})]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"houseName",label:"房号",width:"80"}}),e("el-table-column",{attrs:{prop:"styleName",label:"房型名称"}}),e("el-table-column",{attrs:{prop:"area",label:"面积(㎡)"}}),e("el-table-column",{attrs:{prop:"balcony",label:"阳台",width:"80"}}),e("el-table-column",{attrs:{prop:"price",label:"价格(元/月)"}}),e("el-table-column",{attrs:{prop:"state",label:"状态",width:"80"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"danger",size:"mini",disabled:t.isDel||"已租"==s.row.state},on:{click:function(e){return t.handleDel(s.row)}}},[t._v("删 除")])]}}])})],1)],1)])],1)]],2),e("div",{staticClass:"drawer"},[e("el-drawer",{attrs:{title:t.addTitle,visible:t.drawer,size:"28%",direction:t.direction,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[e("el-form",{ref:"houseForm",attrs:{model:t.houseForm,"label-width":"100px",rules:t.rules}},[e("el-form-item",{attrs:{label:"房 间 号"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.houseForm.houseName,callback:function(e){t.$set(t.houseForm,"houseName",e)},expression:"houseForm.houseName"}})],1),e("el-form-item",{attrs:{label:"房 型",prop:"styleName"}},[e("el-select",{attrs:{placeholder:"请选择房型"},on:{change:t.getStyleArea},model:{value:t.houseForm.styleName,callback:function(e){t.$set(t.houseForm,"styleName",e)},expression:"houseForm.styleName"}},t._l(t.styleNameSelect,(function(t,s){return e("el-option",{key:s,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{attrs:{label:"面 积 (㎡)",prop:"area"}},[e("el-select",{attrs:{placeholder:"请选择面积"},on:{change:t.getStyleBalcony},model:{value:t.houseForm.area,callback:function(e){t.$set(t.houseForm,"area",e)},expression:"houseForm.area"}},t._l(t.styleAreaSelect,(function(t,s){return e("el-option",{key:s,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"阳 台",prop:"balcony"}},[e("el-select",{attrs:{placeholder:"请选择阳台"},model:{value:t.houseForm.balcony,callback:function(e){t.$set(t.houseForm,"balcony",e)},expression:"houseForm.balcony"}},t._l(t.styleBalconySelect,(function(t,s){return e("el-option",{key:s,attrs:{label:t,value:t}})})),1),e("p",{staticClass:"ps",staticStyle:{width:"100%",margin:"0"}},[t._v("*请依次选择房型、面积、阳台 进行添加房间")])],1),e("el-form-item",[e("span",{staticStyle:{"font-size":"12px"}},[t._v("剩 余 房 型 : "+t._s(t.styleAvailable)+" (间)")]),e("span",{staticStyle:{"margin-left":"15px",color:"#00d0b5","font-size":"12px"}},[t._v("可 用 面 积 : "+t._s(t.available)+" (㎡)")]),e("div",[e("el-button",{attrs:{type:"primary",disabled:t.isDisabled},on:{click:t.submit}},[t._v("确 认")]),e("el-button",{on:{click:function(e){return t.reset()}}},[t._v("取 消")])],1)])],1)],1)],1)])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-container"},[e("h1",[t._v("房 间 管 理")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"fr-header"},[e("h1",[t._v("房 屋 总 览")])])}],n=s(50),o=s(5115),l=s(5532),i=s(9176),u=s(6585),c={data(){return{houseNum:[],isCurrent:1,tableData:[],drawer:!1,direction:"rtl",available:"",area:"",houseForm:{houseName:"",styleName:"",area:"",balcony:"",styleId:""},styleAvailable:"",isDisabled:!0,styleNameSelect:[],styleAreaSelect:[],styleBalconySelect:[],rules:{styleName:[{required:!0,message:"请选择房型信息",trigger:"blur"}],area:[{required:!0,message:"请选择面积信息",trigger:"blur"}],balcony:[{required:!0,message:"请选择阳台信息",trigger:"blur"}]}}},created(){this.getHouseNum()},methods:{async getHouseNum(){try{const{data:t}=await(0,o.gh)();this.houseNum=t}catch(t){console.log(t)}},reset(){this.houseForm={houseName:"",styleName:"",area:"",balcony:"",styleId:""},this.drawer=!1},async getArea(t){try{const{data:e}=await(0,n.b)(t);this.available=e.available,this.area=e.area}catch(e){console.log(e)}},async getAll(){await this.getHouseNum(),this.isCurrent=1},goFloor(t){this.isCurrent=t,this.getHouseDetail(),this.getArea(t)},async handleDel(t){this.$confirm("此操作将永久删除该房间, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await(0,o.qb)(t),this.$message.success("删除成功")}catch(e){console.log(e)}finally{this.getHouseDetail()}})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleClose(t){this.$confirm("确认关闭？").then((e=>{this.reset(),t()})).catch((t=>{}))},async getHouseNumber(){try{const{data:t}=await(0,o.Pe)(this.isCurrent);this.houseForm.houseName=t,this.drawer=!0}catch(t){console.log(t)}},add(){try{this.getHouseNumber(),this.getStyleName()}catch(t){console.log(t)}},async submit(){try{await(0,o.L$)({floorId:this.isCurrent,...this.houseForm}),this.$message.success("创建成功")}catch(t){console.log(t)}finally{this.getArea(this.isCurrent),this.getHouseDetail(),this.reset()}},async getStyleName(){this.houseForm.balcony="",this.houseForm.area="";const{data:t}=await(0,l.PG)(this.isCurrent);this.styleNameSelect=t},async getStyleArea(){this.houseForm.balcony="",this.houseForm.area="";const{data:t}=await(0,l.$K)(this.isCurrent,{styleName:this.houseForm.styleName});this.styleAreaSelect=t},async getStyleBalcony(){this.houseForm.balcony="";const{data:t}=await(0,l.x3)(this.isCurrent,{styleName:this.houseForm.styleName,area:this.houseForm.area});this.styleBalconySelect=t},async getHouseDetail(){try{const{data:t}=await(0,o.AD)(this.isCurrent);this.tableData=t}catch(t){console.log(t)}}},computed:{title(){return`第 ${this.isCurrent} 层 详 情 页`},addTitle(){return`添 加 第 ${this.isCurrent} 层 房间`},isAdd(){return u.kL(this.$route.params.type)},isDel(){return u.bK(this.$route.params.type)},isUp(){return u.EN(this.$route.params.type)},isPull(){return u.kX(this.$route.params.type)},isEdit(){return u.mi(this.$route.params.type)},isGet(){return u.Xu(this.$route.params.type)}},watch:{houseForm:{async handler(t,e){if((0,i.n3)(t.styleName)||(0,i.n3)(t.balcony)||(0,i.n3)(t.area))this.styleAvailable="",this.isDisabled=!0;else{const{data:t}=await(0,l.Oj)(this.isCurrent,{styleName:this.houseForm.styleName,area:this.houseForm.area,balcony:this.houseForm.balcony});this.houseForm.styleId=t.styleId,this.styleAvailable=t.available,0==this.styleAvailable?this.isDisabled=!0:Number(this.available)-Number(this.houseForm.area)>=0?this.isDisabled=!1:this.isDisabled=!0}},deep:!0}}},h=c,f=s(1001),d=(0,f.Z)(h,r,a,!1,null,"5d2ce39d",null),m=d.exports},50:function(t,e,s){s.d(e,{W:function(){return n},b:function(){return a}});var r=s(9312);function a(t){return(0,r.U2)(`/getArea/${t}`,{})}function n(){return(0,r.U2)("/getFloor",{})}},5115:function(t,e,s){s.d(e,{AD:function(){return o},L$:function(){return n},Pe:function(){return a},YZ:function(){return l},gh:function(){return c},qb:function(){return i},y1:function(){return u}});var r=s(9312);function a(t){return(0,r.U2)(`/getHouseNumber/${t}`,{})}function n(t){return(0,r.v_)("/insertHouse",t)}function o(t){return(0,r.U2)(`/getHouseDetail/${t}`)}function l(t){return(0,r.U2)("/getHouse",t)}function i(t){return(0,r.U2)("deleteHouse",t)}function u(t){return(0,r.U2)("judgeHouseState",t)}function c(){return(0,r.U2)("getHouseNum",{})}},5532:function(t,e,s){s.d(e,{$K:function(){return c},CQ:function(){return a},KR:function(){return n},Oj:function(){return f},PG:function(){return u},Uz:function(){return i},YN:function(){return o},tn:function(){return l},x3:function(){return h},zs:function(){return d}});var r=s(9312);function a(t){return(0,r.v_)("/insertStyle",t)}function n(t,e){return(0,r.U2)(`/getAllStyle/${t}`,e)}function o(t){return(0,r.U2)(`/resetStyle/${t}/1`)}function l(t){return(0,r.U2)(`/resetStyle/${t}/0`)}function i(t){return(0,r.v_)("/updateStyle",t)}function u(t){return(0,r.U2)(`/getStyleName/${t}`,{})}function c(t,e){return(0,r.U2)(`/getStyleArea/${t}`,e)}function h(t,e){return(0,r.U2)(`/getStyleBalcony/${t}`,e)}function f(t,e){return(0,r.U2)(`/leftStyle/${t}`,e)}function d(){return(0,r.U2)("getAllStyleName",{})}},6585:function(t,e,s){function r(t){const e="1";return u(t,e)}function a(t){const e="2";return u(t,e)}function n(t){const e="3";return u(t,e)}function o(t){const e="4";return u(t,e)}function l(t){const e="5";return u(t,e)}function i(t){const e="6";return u(t,e)}function u(t,e){let s=t.split("").filter((t=>!isNaN(t)));return!s.includes(e)}s.d(e,{EN:function(){return n},Xu:function(){return i},bK:function(){return a},kL:function(){return r},kX:function(){return o},mi:function(){return l}})},9176:function(t,e,s){function r(t){return/^1[3-9]\d{9}$/.test(t)}function a(t){let e=!0;return Object.keys(t).forEach((function(s){null!==t[s]&&""!=t[s]&&(e=!1)})),e}function n(t){return"NaN"!=parseFloat(t).toString()}function o(t){return""===t||null===t}s.d(e,{BP:function(){return n},Lp:function(){return r},kz:function(){return a},n3:function(){return o}})}}]);
//# sourceMappingURL=175.a42e100a.js.map