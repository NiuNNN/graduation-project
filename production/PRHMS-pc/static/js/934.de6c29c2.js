"use strict";(self["webpackChunkpc_web"]=self["webpackChunkpc_web"]||[]).push([[934],{9934:function(t,e,a){a.r(e),a.d(e,{default:function(){return R}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[t._m(0),e("div",{staticClass:"table-container"},[e("div",{staticClass:"navbar"},[e("span",{class:{current:"AllFinancial"==t.isCurrent},on:{click:function(e){return t.changeCurrent("AllFinancial")}}},[t._v("财 务 信 息")]),e("span",{class:{current:"HouseFinancial"==t.isCurrent},on:{click:function(e){return t.changeCurrent("HouseFinancial")}}},[t._v("住 房 信 息")]),e("span",{class:{current:"StaffFinancial"==t.isCurrent},on:{click:function(e){return t.changeCurrent("StaffFinancial")}}},[t._v("员 工 信 息")])]),e("div",{staticClass:"table"},[e(t.isCurrent,{tag:"component"})],1)])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-container"},[e("h1",[t._v("财 务 报 表")])])}],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("div",{staticClass:"table-container"},[e("div",{staticClass:"navbar"},[e("div",{staticStyle:{width:"60%"}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"50px",inline:!0}},[e("el-form-item",{attrs:{label:"房号"}},[e("el-input",{attrs:{placeholder:"请输入房号"},model:{value:t.form.houseName,callback:function(e){t.$set(t.form,"houseName",e)},expression:"form.houseName"}})],1),e("el-form-item",{attrs:{label:"时间"}},[e("el-date-picker",{attrs:{type:"month",placeholder:"请选择时间","picker-options":t.pickerBeginOption,"value-format":"yyyy-MM"},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}})],1),e("el-button",{staticStyle:{height:"35px","line-height":"5px","margin-top":"2px"},attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)],1),e("div",{staticStyle:{"margin-right":"35px"}},[e("el-button",{staticStyle:{height:"35px","line-height":"5px"},attrs:{disabled:t.isGet},on:{click:function(e){t.dialogVisible=!0}}},[t._v("生成账单")]),e("el-button",{staticStyle:{height:"35px","line-height":"5px"},attrs:{disabled:t.isGet},on:{click:t.getAllCostExcel}},[t._v("一键导出")])],1)]),e("div",{staticClass:"table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",height:"454","default-sort":{prop:"date",order:"descending"},"row-key":t.getRowKey},on:{"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":200}})]},proxy:!0}])},[e("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.selectInit}}),e("el-table-column",{attrs:{prop:"date",label:"时间",sortable:""}}),e("el-table-column",{attrs:{prop:"houseName",label:"房号"}}),e("el-table-column",{attrs:{prop:"numElectric",label:"用电量(度)"}}),e("el-table-column",{attrs:{prop:"costElectric",label:"电费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return["待处理"!=a.row.numElectric?e("span",[t._v("￥"+t._s(a.row.costElectric))]):e("span",[t._v(t._s(a.row.costElectric))])]}}])}),e("el-table-column",{attrs:{prop:"numWater",label:"用水量(方)"}}),e("el-table-column",{attrs:{prop:"costWater",label:"水费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return["待处理"!=a.row.numWater?e("span",[t._v("￥"+t._s(a.row.costWater))]):e("span",[t._v(t._s(a.row.costWater))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.state?e("el-button",{attrs:{type:"primary",size:"small",disabled:t.isGet},on:{click:function(e){return t.generateRent(a.row)}}},[t._v("导 出")]):e("el-button",{attrs:{type:"primary",size:"small",disabled:t.isEdit},on:{click:function(e){return t.generateRent(a.row)}}},[t._v("报 表")]),e("el-button",{attrs:{type:"danger",size:"small",disabled:t.isDel||"0"!=a.row.state},on:{click:function(e){return t.deleteCost(a.row)}}},[t._v("删 除")])]}}])})],1)],1),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{"current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize,background:"",layout:"prev, pager, next",total:t.pagination.total},on:{"current-change":t.handleCurrentChange}})],1),e("div",{staticClass:"dialog"},[e("el-dialog",{attrs:{title:"报表",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.generate,"label-width":"50px",inline:!0}},[e("el-form-item",{attrs:{label:"时间"}},[e("el-date-picker",{attrs:{type:"month",placeholder:"请选择时间","picker-options":t.pickerBeginOption,"value-format":"yyyy-MM"},model:{value:t.generate.month,callback:function(e){t.$set(t.generate,"month",e)},expression:"generate.month"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addAll}},[t._v("确 定")])],1)],1)],1)])])},s=[],l=a(6585),o=a(4980),c=a(2900),u={data(){return{pickerBeginOption:{disabledDate:t=>t.getTime()>Date.now()},dialogVisible:!1,form:{month:"",houseName:""},tableData:[],pagination:{currentPage:1,pageSize:7,total:0},password:"",personData:[],generate:{month:""},multipleSelection:[]}},created(){this.getAll()},methods:{selectInit(t,e){return 0!=t.state},getRowKey(t){return t.costId},async addAll(){this.$confirm("此操作将生成住房账单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$prompt("请输入密码","生成账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username}),await(0,o.rb)({time:this.generate.month}),await(0,o.$T)({time:this.generate.month})}catch(e){console.log(e)}finally{this.getAll(),this.generate={month:""},this.dialogVisible=!1}}))})).catch((()=>{this.$message({type:"info",message:"已取消生成"})}))},async getAll(){try{const t=`${this.pagination.currentPage}/${this.pagination.pageSize}`,{data:e}=await(0,o.Fo)(t,{houseName:this.form.houseName,date:this.form.month});this.tableData=e.records,this.pagination.currentPage=e.current,this.pagination.total=e.total,this.pagination.pageSize=e.size}catch(t){console.log(t)}},handleCurrentChange(t){this.pagination.currentPage=t,this.getAll()},search(){this.getAll(),this.form={month:"",houseName:""}},generateRent(t){"待处理"==t.numElectric||"待处理"==t.numWater?this.$message.info(`请先录入 ${t.houseName}房 该月用电或用水信息信息`):this.$confirm(`此操作将生成 ${t.houseName}房 该月账单, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:e})=>{try{await(0,c.uo)({password:e,username:this.$store.getters.username}),console.log(t),await(0,o.rQ)(t)}catch(a){console.log(a)}finally{this.getAll()}}))})).catch((()=>{this.$message({type:"info",message:"已取消生成"})}))},deleteCost(t){this.$prompt("请输入密码","删除",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:e})=>{try{await(0,c.uo)({password:e,username:this.$store.getters.username}),await(0,o.KH)({costId:t.costId})}catch(a){console.log(a)}finally{this.getAll()}})).catch((()=>{this.$message({type:"info",message:"取消删除"})}))},handleSelectionChange(t){this.multipleSelection=t,console.log(this.multipleSelection)},getAllCostExcel(){this.multipleSelection.length>0?this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username}),await(0,o.oD)({list:JSON.stringify(this.multipleSelection)})}catch(e){console.log(e)}finally{this.multipleSelection=[]}})):this.$message.info("请勾选后导出账单...")}},computed:{isAdd(){return l.kL(this.$route.params.type)},isDel(){return l.bK(this.$route.params.type)},isUp(){return l.EN(this.$route.params.type)},isPull(){return l.kX(this.$route.params.type)},isEdit(){return l.mi(this.$route.params.type)},isGet(){return l.Xu(this.$route.params.type)},isTooggle(){return!(this.multipleSelection.length>0)}}},p=u,m=a(1001),d=(0,m.Z)(p,r,s,!1,null,"dcfc4122",null),f=d.exports,h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("div",{staticClass:"table-container"},[e("div",{staticClass:"navbar"},[e("div",{staticStyle:{width:"60%"}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"50px",inline:!0}},[e("el-form-item",{attrs:{label:"姓名"}},[e("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"时间"}},[e("el-date-picker",{attrs:{type:"month",placeholder:"请选择时间","picker-options":t.pickerBeginOption,"value-format":"yyyy-MM"},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1),e("el-button",{staticStyle:{height:"35px","line-height":"5px","margin-top":"2px"},attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)],1),e("div",{staticStyle:{"margin-right":"35px"}},[e("el-button",{staticStyle:{height:"35px","line-height":"5px"},attrs:{disabled:t.isGet},on:{click:t.generateStaffSalary}},[t._v("生成账单")]),e("el-button",{staticStyle:{height:"35px","line-height":"5px"},attrs:{disabled:t.isGet},on:{click:function(e){return t.generateStaffExcel("all")}}},[t._v("一键导出")])],1)]),e("div",{staticClass:"table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",height:"454","default-sort":{prop:"date",order:"descending"},"row-key":t.getRowKey},on:{"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":200}})]},proxy:!0}])},[e("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),e("el-table-column",{attrs:{prop:"time",label:"时间",sortable:""}}),e("el-table-column",{attrs:{prop:"username",label:"账号",width:"120"}}),e("el-table-column",{attrs:{prop:"name",label:"姓名",width:"80"}}),e("el-table-column",{attrs:{prop:"roleName",label:"职位"}}),e("el-table-column",{attrs:{label:"基本薪水(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.basePrice))])]}}])}),e("el-table-column",{attrs:{label:"福利(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.elsePrice))])]}}])}),e("el-table-column",{attrs:{prop:"price",label:"总薪水(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.price))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"small",disabled:t.isGet},on:{click:function(e){return t.generateStaffExcel("single",a.row)}}},[t._v("导 出")])]}}])})],1)],1),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{"current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize,background:"",layout:"prev, pager, next",total:t.pagination.total},on:{"current-change":t.handleCurrentChange}})],1)])])},g=[],y=(a(7658),a(4828)),b={data(){return{pickerBeginOption:{disabledDate:t=>t.getTime()>Date.now()},dialogVisible:!1,form:{time:"",name:""},tableData:[],pagination:{currentPage:1,pageSize:7,total:0},password:"",multipleSelection:[]}},created(){this.getAll()},methods:{getRowKey(t){return t.id},async getAll(){try{const t=`${this.pagination.currentPage}/${this.pagination.pageSize}`,{data:e}=await(0,y.Cd)(t,{name:this.form.name,time:this.form.time});this.tableData=e.records,this.pagination.currentPage=e.current,this.pagination.total=e.total,this.pagination.pageSize=e.size}catch(t){console.log(t)}},handleCurrentChange(t){this.pagination.currentPage=t,this.getAll()},search(){this.getAll(),this.form={time:"",name:""}},handleSelectionChange(t){this.multipleSelection=t,console.log(this.multipleSelection)},async generateStaffExcel(t,e){"all"==t?this.multipleSelection.length>0?this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username}),await(0,y.aP)({list:JSON.stringify(this.multipleSelection)})}catch(e){console.log(e)}finally{this.multipleSelection=[]}})):this.$message.info("请勾选后导出账单..."):"single"==t&&this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username});let a=[];a.push(e),await(0,y.aP)({list:JSON.stringify(a)})}catch(a){console.log(a)}}))},generateStaffSalary(){this.$confirm("此操作将生成全部员工薪水账单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,y.yg)(),await(0,c.uo)({password:t,username:this.$store.getters.username}),await(0,y.MS)()}catch(e){console.log(e)}finally{this.getAll()}}))})).catch((()=>{this.$message({type:"info",message:"已取消生成"})}))}},computed:{isAdd(){return l.kL(this.$route.params.type)},isDel(){return l.bK(this.$route.params.type)},isUp(){return l.EN(this.$route.params.type)},isPull(){return l.kX(this.$route.params.type)},isEdit(){return l.mi(this.$route.params.type)},isGet(){return l.Xu(this.$route.params.type)},isTooggle(){return!(this.multipleSelection.length>0)}}},w=b,v=(0,m.Z)(w,h,g,!1,null,"afb6d16c",null),_=v.exports,S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("div",{staticClass:"table-container"},[e("div",{staticClass:"left"},[e("div",{staticClass:"bg"},[e("financial-chart",{key:t.datekey})],1)]),e("div",{staticClass:"right"},[e("div",{staticClass:"table"},[e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",height:"615","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":200}})]},proxy:!0}])},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{prop:"date",label:"时间",sortable:"",width:"80"}}),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"75"}}),e("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"header",fn:function(a){return[e("el-date-picker",{attrs:{size:"mini",type:"month",placeholder:"请选择时间","picker-options":t.pickerBeginOption,"value-format":"yyyy-MM"},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}}),e("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:t.search}}),e("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-download"},on:{click:function(e){return t.download("all")}}})]}},{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",disabled:t.isGet},on:{click:function(e){return t.showDrawer(a.row)}}},[t._v("查 看")]),e("el-button",{attrs:{type:"primary",size:"mini",disabled:t.isGet},on:{click:function(e){return t.download("single",a.row)}}},[t._v("导 出")])]}}])})],1)],1)]),e("div",{staticClass:"drawer"},[e("el-drawer",{attrs:{title:t.title,visible:t.drawer,"destroy-on-close":!0,size:"50%"},on:{"update:visible":function(e){t.drawer=e}}},[e("div",{staticClass:"bg"},[e("div",{staticClass:"main"},[e("el-descriptions",{attrs:{title:" 审核信息",column:3,size:"mini"}},[e("template",{slot:"extra"},[e("el-button",{attrs:{type:"primary",size:"small",disabled:1==this.financial.state},on:{click:t.judgeGenerateFinancial}},[t._v("操作")])],1),e("el-descriptions-item",{attrs:{label:"年月"}},[t._v(t._s(t.financial.date))]),e("el-descriptions-item",{attrs:{label:"审核状态"}},[t._v(t._s(t.financial.status))]),e("el-descriptions-item",{attrs:{label:"审核人"}},[t._v(t._s(t.financial.name))]),e("el-descriptions-item",{attrs:{label:"审核时间"}},[t._v(t._s(t.financial.time))]),e("el-descriptions-item",{attrs:{label:"水费总支出"}},[t._v(t._s(t.financial.outWater))]),e("el-descriptions-item",{attrs:{label:"电费总支出"}},[t._v(t._s(t.financial.outElectric))]),e("el-descriptions-item",{attrs:{label:"薪水总支出"}},[t._v(t._s(t.financial.outSalary))]),e("el-descriptions-item",{attrs:{label:"杂费总支出"}},[t._v(t._s(t.financial.outMis))]),e("el-descriptions-item",{attrs:{label:"水费总收入"}},[t._v(t._s(t.financial.inWater))]),e("el-descriptions-item",{attrs:{label:"电费总收入"}},[t._v(t._s(t.financial.inElectric))]),e("el-descriptions-item",{attrs:{label:"水费总盈利"}},[t._v(t._s(t.financial.proWater))]),e("el-descriptions-item",{attrs:{label:"电费总盈利"}},[t._v(t._s(t.financial.proElectric))]),e("el-descriptions-item",{attrs:{label:"杂费总收入"}},[t._v(t._s(t.financial.inMis))]),e("el-descriptions-item",{attrs:{label:"租金总收入"}},[t._v(t._s(t.financial.inRent))]),e("el-descriptions-item",{attrs:{label:"总收入"}},[t._v(t._s(t.financial.advanceTotal))]),e("el-descriptions-item",{attrs:{label:"总支出"}},[t._v(t._s(t.financial.realTotal))]),e("el-descriptions-item",{attrs:{label:"获利"}},[t._v(t._s(t.financial.finalTotal))])],2)],1)]),e("div",{staticClass:"bg"},[e("div",{staticClass:"main"},[e("el-descriptions",{attrs:{title:" 房屋收入"}}),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.houseTable,stripe:"",height:"250",size:"small"},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":80}})]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"houseName",label:"房号"}}),e("el-table-column",{attrs:{prop:"numElectric",label:"用电量(度)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.numElectric?e("span",[t._v(t._s(a.row.numElectric))]):e("span",[t._v("待处理")])]}}])}),e("el-table-column",{attrs:{prop:"costElectric",label:"电费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.costElectric?e("span",[t._v("￥"+t._s(a.row.costElectric))]):e("span",[t._v("待处理")])]}}])}),e("el-table-column",{attrs:{prop:"numWater",label:"用水量(方)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.numWater?e("span",[t._v(t._s(a.row.numWater))]):e("span",[t._v("待处理")])]}}])}),e("el-table-column",{attrs:{prop:"costWater",label:"水费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.costWater?e("span",[t._v("￥"+t._s(a.row.costWater))]):e("span",[t._v("待处理")])]}}])}),e("el-table-column",{attrs:{prop:"mis",label:"杂费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.mis?e("span",[t._v("￥"+t._s(a.row.mis))]):e("span",[t._v("待处理")])]}}])}),e("el-table-column",{attrs:{prop:"total",label:"总收费(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[null!=a.row.total?e("span",[t._v("￥"+t._s(a.row.total))]):e("span",[t._v("待处理")])]}}])})],1)],1)]),e("div",{staticClass:"bg"},[e("div",{staticClass:"main"},[e("el-descriptions",{attrs:{title:" 薪水支出"}}),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.salaryTable,stripe:"",height:"250",size:"small"},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":80}})]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"username",label:"账号",width:"120"}}),e("el-table-column",{attrs:{prop:"name",label:"姓名",width:"80"}}),e("el-table-column",{attrs:{prop:"roleName",label:"职位"}}),e("el-table-column",{attrs:{label:"基本薪水(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.basePrice))])]}}])}),e("el-table-column",{attrs:{label:"福利(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.elsePrice))])]}}])}),e("el-table-column",{attrs:{prop:"price",label:"总薪水(元)"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.price))])]}}])})],1)],1)]),e("div",{staticClass:"bg"},[e("div",{staticClass:"main"},[e("el-descriptions",{attrs:{title:" 其他支出"}}),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.misTable,stripe:"",height:"250",size:"small"},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{"image-size":80}})]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"time",label:"时间"}}),e("el-table-column",{attrs:{prop:"type",label:"支出种类"}}),e("el-table-column",{attrs:{prop:"total",label:"金额(元)"}})],1)],1)])])],1),e("div",{staticClass:"dialog"},[e("el-dialog",{attrs:{title:"水电标准信息",visible:t.dialogFormVisible,width:"40%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{attrs:{model:t.form,rules:t.rules}},[e("el-form-item",{attrs:{label:"标准水费:","label-width":t.formLabelWidth,prop:"water"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.water,callback:function(e){t.$set(t.form,"water",e)},expression:"form.water"}})],1),e("el-form-item",{attrs:{label:"标准电费:","label-width":t.formLabelWidth,prop:"electric"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.electric,callback:function(e){t.$set(t.form,"electric",e)},expression:"form.electric"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.generateFinancial}},[t._v("确 定")])],1)],1)],1)])])},k=[],x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart-container"},[e("p",[t._v(t._s(t.title))]),e("div",{attrs:{id:"chart-main"}})])},$=[],C=a(9312);function T(){return(0,C.U2)("getFinancialChart",{})}function E(t){return(0,C.U2)("getAllFinancial",t)}function B(t){return(0,C.Ab)("getFinancialExcel",t)}function A(t){return(0,C.U2)("getFinancialDetail",t)}function F(t){return(0,C.U2)("judgeGenerateFinancial",t)}function P(t){return(0,C.v_)("generateFinancial",t)}var z={data(){return{source:[]}},mounted(){this.drawChart()},methods:{async getFinancialChart(){try{const{data:t}=await T();this.source=t}catch(t){console.log(t)}},async drawChart(){await this.getFinancialChart();let t=this.$echarts.init(document.getElementById("chart-main")),e={legend:{},tooltip:{trigger:"axis",showContent:!1},dataset:{source:this.source},xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%"},series:[{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"pie",id:"pie",radius:"30%",center:["50%","30%"],emphasis:{focus:"self"},label:{formatter:"{b}: {@4} ({d}%)"},encode:{itemName:"Financial",value:"4",tooltip:"4"}}]};t.on("updateAxisPointer",(function(e){const a=e.axesInfo[0];if(a){const e=a.value+1;t.setOption({series:{id:"pie",label:{formatter:"{b}: {@["+e+"]} ({d}%)"},encode:{value:e,tooltip:e}}})}})),t.setOption(e)}},computed:{title(){const t=new Date;return`${t.getFullYear()}年 财务状况`}}},D=z,N=(0,m.Z)(D,x,$,!1,null,"eea0c3bc",null),W=N.exports,M=a(9176),U={components:{FinancialChart:W},async created(){await this.getAllFinancial()},data(){const t=(t,e,a)=>{(0,M.BP)(e)?a():a(new Error("请输入数字"))};return{pickerBeginOption:{disabledDate:t=>t.getTime()>Date.now()},datekey:Date.now(),dialogFormVisible:!1,month:"",tableData:[],houseTable:[],salaryTable:[],misTable:[],multipleSelection:[],drawer:!1,title:"",financial:{},formLabelWidth:"120px",form:{water:"",electric:""},rules:{water:[{required:!0,message:"请输入标准水费",trigger:"blur"},{validator:t,message:"水费必须为数字值",trigger:"blur"}],electric:[{required:!0,message:"请输入标准电费",trigger:"blur"},{validator:t,message:"电费费必须为数字值",trigger:"blur"}]}}},methods:{async judgeGenerateFinancial(){this.$prompt("请输入密码",`${this.financial.date} 财务账单生成`,{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username}),await F({date:this.financial.date}),this.dialogFormVisible=!0}catch(e){console.log(e)}finally{this.getAllFinancial()}}))},handleSelectionChange(t){this.multipleSelection=t},async getAllFinancial(){try{const{data:t}=await E({date:this.month});this.tableData=t}catch(t){console.log(t)}},async search(){await this.getAllFinancial(),this.month=""},download(t,e){"all"==t?this.multipleSelection.length>0?this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username}),await B({list:JSON.stringify(this.multipleSelection)})}catch(e){console.log(e)}finally{this.multipleSelection=[]}})):this.$message.info("请勾选后导出账单..."):"single"==t&&this.$prompt("请输入密码","导出账单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^\w{5,12}$/,inputErrorMessage:"密码格式不正确"}).then((async({value:t})=>{try{await(0,c.uo)({password:t,username:this.$store.getters.username});let a=[];a.push(e),await B({list:JSON.stringify(a)})}catch(a){console.log(a)}}))},async showDrawer(t){try{this.title=`${t.date} 财务信息`,this.financial=t,this.drawer=!0;const{data:e}=await A({date:t.date});this.houseTable=e.houseTable[0],this.salaryTable=e.salaryTable[0],this.misTable=e.misTable[0]}catch(e){console.log(e)}},generateFinancial(){this.$confirm("请确认输入的标准水电金额是否正确?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{console.log(this.financial),await P({userId:this.$store.getters.userId,date:this.financial.date,...this.form}),this.$message.success(`${this.title} 财务信息生成成功...`)}catch(t){console.log(t)}finally{this.getAllFinancial(),this.datekey=Date.now(),this.dialogFormVisible=!1,this.drawer=!1}})).catch((()=>{}))}},computed:{isAdd(){return l.kL(this.$route.params.type)},isDel(){return l.bK(this.$route.params.type)},isUp(){return l.EN(this.$route.params.type)},isPull(){return l.kX(this.$route.params.type)},isEdit(){return l.mi(this.$route.params.type)},isGet(){return l.Xu(this.$route.params.type)}}},L=U,G=(0,m.Z)(L,S,k,!1,null,"7386a19c",null),O=G.exports,I={components:{HouseFinancial:f,StaffFinancial:_,AllFinancial:O},data(){return{isCurrent:"AllFinancial"}},methods:{changeCurrent(t){this.isCurrent=t}}},V=I,K=(0,m.Z)(V,n,i,!1,null,"faae0f36",null),R=K.exports},4980:function(t,e,a){a.d(e,{$T:function(){return y},Fo:function(){return m},GC:function(){return w},JQ:function(){return c},KH:function(){return h},Wm:function(){return p},_L:function(){return r},_x:function(){return s},cs:function(){return u},gD:function(){return f},i8:function(){return d},iJ:function(){return o},mw:function(){return i},n$:function(){return l},oD:function(){return v},rQ:function(){return g},rb:function(){return b}});var n=a(9312);function i(){return(0,n.Ab)("sheetElectricExcel",{})}function r(){return(0,n.Ab)("sheetWaterExcel",{})}function s(t){return(0,n.cd)("getElectricExcel",t)}function l(t){return(0,n.cd)("getWaterExcel",t)}function o(t){return(0,n.v_)("judgeElectric",t)}function c(t){return(0,n.v_)("judgeWater",t)}function u(t){return(0,n.v_)("toggleElectric",t)}function p(t){return(0,n.v_)("toggleWater",t)}function m(t,e){return(0,n.U2)(`getAllCost/${t}`,e)}function d(t){return(0,n.U2)("updateElectricByCostId",t)}function f(t){return(0,n.U2)("updateWaterByCostId",t)}function h(t){return(0,n.U2)("deleteCost",t)}function g(t){return(0,n.Ab)("generatePersonCost",t)}function y(t){return(0,n.Ab)("generateAllCost",t)}function b(t){return(0,n.U2)("judgeCost",t)}function w(t){return(0,n.U2)("getCostByRentId",t)}function v(t){return(0,n.Ab)("getAllCostExcel",t)}},4828:function(t,e,a){a.d(e,{Cd:function(){return c},MS:function(){return p},S2:function(){return o},XH:function(){return l},aP:function(){return u},oR:function(){return d},qY:function(){return s},tA:function(){return r},wO:function(){return i},yg:function(){return m}});var n=a(9312);function i(t){return(0,n.U2)(`getAllSalary/${t}`,{})}function r(t){return(0,n.v_)("insertSalary",t)}function s(t){return(0,n.v_)("updateSalary",t)}function l(t){return(0,n.U2)("deleteSalary",t)}function o(t){return(0,n.U2)("getSalaryMap",t)}function c(t,e){return(0,n.U2)(`selectSalaryPay/${t}`,e)}function u(t){return(0,n.Ab)("generateStaffExcel",t)}function p(){return(0,n.Ab)("generateStaffSalary",{})}function m(){return(0,n.U2)("judgeGenerateStaff",{})}function d(t){return(0,n.U2)("getUserSalaryByUserId",t)}},6585:function(t,e,a){function n(t){const e="1";return c(t,e)}function i(t){const e="2";return c(t,e)}function r(t){const e="3";return c(t,e)}function s(t){const e="4";return c(t,e)}function l(t){const e="5";return c(t,e)}function o(t){const e="6";return c(t,e)}function c(t,e){let a=t.split("").filter((t=>!isNaN(t)));return!a.includes(e)}a.d(e,{EN:function(){return r},Xu:function(){return o},bK:function(){return i},kL:function(){return n},kX:function(){return s},mi:function(){return l}})},9176:function(t,e,a){function n(t){return/^1[3-9]\d{9}$/.test(t)}function i(t){let e=!0;return Object.keys(t).forEach((function(a){null!==t[a]&&""!=t[a]&&(e=!1)})),e}function r(t){return"NaN"!=parseFloat(t).toString()}function s(t){return""===t||null===t}a.d(e,{BP:function(){return r},Lp:function(){return n},kz:function(){return i},n3:function(){return s}})}}]);
//# sourceMappingURL=934.de6c29c2.js.map