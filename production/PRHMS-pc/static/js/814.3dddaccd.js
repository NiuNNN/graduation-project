"use strict";(self["webpackChunkpc_web"]=self["webpackChunkpc_web"]||[]).push([[814],{2249:function(t,e,r){r.d(e,{Z:function(){return f}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("h3",[t._v("账号:"+t._s(t.user.username))]),e("el-form",{ref:"userForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.userForm,size:"small",rules:t.rules}},[e("el-form-item",{attrs:{label:"用户电话:",prop:"phone"}},[e("el-input",{attrs:{placeholder:"请输入新的电话号码"},model:{value:t.userForm.phone,callback:function(e){t.$set(t.userForm,"phone",e)},expression:"userForm.phone"}})],1),e("el-form-item",{attrs:{label:"密码:",prop:"password"}},[e("el-input",{attrs:{placeholder:"请输入新的密码"},model:{value:t.userForm.password,callback:function(e){t.$set(t.userForm,"password",e)},expression:"userForm.password"}})],1)],1),e("div",{staticClass:"idcard"},[e("span",{staticClass:"idcard-header"},[t._v("身份证照片")]),e("div",{staticClass:"idcard-flex"},[e("div",{class:[{error:t.isErrorFont},{idcard_container:!0}],on:{click:function(e){return t.uploadAvatar("font")}}},[e("input",{ref:"fontRef",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/jpeg"},on:{change:function(e){return t.onFileChange(e,"font")}}}),t.fontUrl?e("img",{attrs:{src:t.fontUrl,alt:""}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"},[t._v("带国徽面")])]),e("div",{class:[{error:t.isErrorBack},{idcard_container:!0}],on:{click:function(e){return t.uploadAvatar("back")}}},[e("input",{ref:"backRef",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/jpeg"},on:{change:function(e){return t.onFileChange(e,"back")}}}),t.backUrl?e("img",{attrs:{src:t.backUrl,alt:""}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"},[t._v("带头像面")])])])]),e("div",{staticClass:"btn"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")]),e("el-button",{on:{click:t.close}},[t._v("取 消")])],1)],1)},s=[],n=r(2900);function i(t){return null==t||""==t}var o={props:{user:{type:Object,default:()=>({})}},data(){return{fontUrl:"",backUrl:"",fontFile:"",backFile:"",username:"",isErrorFont:!1,isErrorBack:!1,rules:{phone:[{required:!1,trigger:"blur",message:"请输入住户手机"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],password:[{required:!1,message:"请输入密码",trigger:"blur"},{pattern:/^\w{5,12}$/,message:"请输入正确的秘密",trigger:"blur"}]},isfont:!1,isback:!1,userForm:{phone:"",password:""},newUser:{}}},methods:{uploadAvatar(t){"font"===t&&this.$refs.fontRef.click(),"back"===t&&this.$refs.backRef.click()},onFileChange(t,e){const r=t.target.files;if(0!==r.length&&this.beforeAvatarUpload(r[0])){const t=new FileReader;t.readAsDataURL(r[0]),t.onload=async t=>{try{"font"===e&&(this.isfont=!1,this.fontUrl=t.target.result,this.fontFile=r[0],this.isErrorFont=!0),"back"===e&&(this.isback=!1,this.backUrl=t.target.result,this.backFile=r[0],this.isErrorBack=!0);const a=new FormData;a.append("file",r[0]),a.append("direction",e);const{data:s}=await(0,n.RA)(a);"font"===s&&(this.isErrorFont=!1,this.isfont=!0),"back"===s&&(this.isErrorBack=!1,this.isback=!0),this.$message.success("校验通过")}catch(a){console.log(a)}}}},beforeAvatarUpload(t){const e="image/jpeg"===t.type,r=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&r},submit(){this.newUser=this.user,this.$refs.userForm.validate((async t=>{if(t){if(this.isfont&&this.isback)try{const t=new FormData;t.append("font",this.fontFile),t.append("back",this.backFile),t.append("username",this.user.username);const{data:e}=await(0,n.C1)(t);this.newUser={...this.newUser,...e},console.log(this.newUser),this.$message.success("修改成功")}catch(e){console.log(e)}if(!i(this.userForm.password)||!i(this.userForm.phone))try{await(0,n.Nq)({...this.userForm,username:this.user.username}),this.newUser={...this.newUser,...this.userForm},i(this.userForm.phone),console.log(this.newUser),this.$message.success("修改成功")}catch(e){console.log(e)}this.$emit("updateUser",this.newUser)}}))},close(){this.newUser=this.user,this.$emit("updateUser",this.newUser)}}},l=o,c=r(1001),u=(0,c.Z)(l,a,s,!1,null,"6ead624c",null),f=u.exports},8814:function(t,e,r){r.r(e),r.d(e,{default:function(){return z}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-container"},[e("div",{staticClass:"left"},[e("div",{staticClass:"header-container"},[t._v("用 户 设 置")]),e("div",{staticClass:"information-container"},[e("div",{staticClass:"avatar-container"},[e("div",{staticClass:"avatar"},[e("input",{ref:"iptRef",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/jpeg"},on:{change:t.onFileChange}}),e("img",{directives:[{name:"imageerror",rawName:"v-imageerror",value:t.defaultImg,expression:"defaultImg"}],attrs:{src:t.user.avatar,alt:""},on:{click:t.uploadAvatar}}),e("div",{staticClass:"camera",on:{click:t.uploadAvatar}},[e("i",{staticClass:"el-icon-camera-solid"})])]),e("p",[t._v(t._s(t.user.username))]),e("p",[t._v("最 近 更 新 时 间："+t._s(t.user.remark))])]),e("div",{staticClass:"choose"},[e("ul",[e("li",{class:{li_active:"PersonalInformation"==t.isCurrent},on:{click:function(e){return t.changeInformation("PersonalInformation")}}},[e("p",[e("i",{class:{"el-icon-user":!0,i_active:"PersonalInformation"===t.isCurrent}}),t._v("个 人 信 息")])]),e("li",{class:{li_active:"FinancialInformation"===t.isCurrent},on:{click:function(e){return t.changeInformation("FinancialInformation")}}},[e("p",[e("i",{class:{"el-icon-coin":!0,i_active:"FinancialInformation"===t.isCurrent}}),t._v("财 务 信 息")])]),e("li",{class:{li_active:"ContractInformation"===t.isCurrent},on:{click:function(e){return t.changeInformation("ContractInformation")}}},[e("p",[e("i",{class:{"el-icon-tickets":!0,i_active:"ContractInformation"===t.isCurrent}}),t._v("合 同 信 息")])])])])])]),e("div",{staticClass:"right"},[e(t.isComponent,{tag:"component"})],1)])},s=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-container"},[e("div",{staticClass:"btn"},[e("el-button",{staticClass:"save",on:{click:function(e){t.idcardDrawer=!0}}},[t._v("更 新")])],1),e("div",{staticClass:"bg"},[e("span",{staticClass:"header"},[t._v("个 人 信 息")]),e("div",{staticClass:"profile"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"姓 名",value:t.user.name}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"账 号",value:t.user.username}})],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"电 话",value:t.user.phone}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"性 别",value:t.user.sex}})],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"民 族",value:t.user.nation}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"生 日",value:t.user.birthday}})],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"身 份 证",value:t.user.idcard}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"签 订 时 间",value:t.user.sign}})],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"过 期 时 间",value:t.user.lose}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"签 订 机 构",value:t.user.authority}})],1)],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("p",[t._v("地 址")]),e("div",{staticClass:"val"},[t._v(t._s(t.user.address))])])],1)],1)]),e("div",{staticClass:"drawer"},[e("div",{staticClass:"drawer"},[e("el-drawer",{attrs:{wrapperClosable:!1,"show-close":!1,title:"修改员工信息",visible:t.idcardDrawer,"destroy-on-close":!0,size:"50%"},on:{"update:visible":function(e){t.idcardDrawer=e}}},[e("update-user",{attrs:{user:t.user},on:{updateUser:t.updateUser}})],1)],1)])])},i=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"profile-detail"},[e("p",[t._v(t._s(t.label))]),e("div",{staticClass:"val"},[t._v(t._s(t.value))])])},l=[],c={props:{label:String,value:String}},u=c,f=r(1001),d=(0,f.Z)(u,o,l,!1,null,"16809d0e",null),p=d.exports,h=r(2249),v={components:{ProfileDetail:p,UpdateUser:h.Z},data(){return{idcardDrawer:!1,user:this.$store.getters.user}},methods:{async updateUser(t){this.user=t,await this.$store.dispatch("user/getUser"),this.idcardDrawer=!1}}},m=v,g=(0,f.Z)(m,n,i,!1,null,"12fbc8c8",null),b=g.exports,C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-container"},[e("div",{staticClass:"bg"},[e("span",{staticClass:"header"},[t._v("合 同 信 息")]),e("div",{staticClass:"contract"},[t.isShow?e("iframe",{staticStyle:{width:"100%",height:"500px"},attrs:{frameborder:"0",src:t.pdfSrc}}):e("el-empty",{attrs:{description:"获取为空"}})],1)])])},w=[],y=r(3811),U=r(7278),_={data(){return{pdfSrc:"",isShow:!1}},created(){this.getContractByUserId()},methods:{async getContractByUserId(){const{data:t}=await(0,y.pk)({userId:this.$store.getters.userId});null!=t&&(this.pdfSrc=`${U.Z}/view/Contract/${t.url}`)}},watch:{pdfSrc:{handler(t,e){this.isShow=""!=t},immediate:!0}}},k=_,S=(0,f.Z)(k,C,w,!1,null,"f638c8b0",null),F=S.exports,I=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"bg"},[e("div",{staticClass:"header"},[e("span",[t._v("财 务 信 息")]),e("div",{staticClass:"financial"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"职位",value:t.role.roleName}})],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"基础工资",value:t.base}})],1),e("el-col",{attrs:{span:12}},[e("profile-detail",{attrs:{label:"实习工资",value:t.probation}})],1),t._l(t.elseSalary,(function(t,r){return e("el-col",{key:r,attrs:{span:12}},[e("profile-detail",{attrs:{label:t.salaryName,value:t.price}})],1)}))],2)],1)])])])},$=[],R=r(4828),A=r(730),B={components:{ProfileDetail:p},data(){return{role:{},baseSalary:[],probationSalary:[],elseSalary:[],base:"0.00",probation:"0.00"}},created(){this.getAll()},methods:{async getAll(){try{const{data:t}=await(0,R.oR)({userId:this.$store.getters.userId});this.baseSalary=t.baseSalary,this.probationSalary=t.probationSalary,this.elseSalary=t.elseSalary,this.baseSalary.length>0&&(this.base=this.baseSalary[0].price,this.probation=this.probationSalary[0].price);const{data:e}=await(0,A.Rg)({userId:this.$store.getters.userId});this.role=e}catch(t){console.log(t)}}}},P=B,D=(0,f.Z)(P,I,$,!1,null,"9ad065c2",null),x=D.exports,E=r(2900),Z={components:{PersonalInformation:b,ContractInformation:F,FinancialInformation:x},data(){return{user:{avatar:"",remark:""},isComponent:"PersonalInformation",isCurrent:"PersonalInformation",defaultImg:r(7239)}},created(){this.user={...this.$store.getters.user}},methods:{changeInformation(t){this.isComponent=t,this.isCurrent=t},uploadAvatar(){this.$refs.iptRef.click()},onFileChange(t){const e=t.target.files;if(0!==e.length&&this.beforeAvatarUpload(e[0])){const t=new FileReader;t.readAsDataURL(e[0]),t.onload=async t=>{this.user.avatar=t.target.result;const r=new FormData;r.append("file",e[0]),r.append("username",this.$store.getters.username),await(0,E.uQ)(r),this.$store.dispatch("user/getUser")}}},beforeAvatarUpload(t){const e="image/jpeg"===t.type,r=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&r}}},j=Z,q=(0,f.Z)(j,a,s,!1,null,"6f29395f",null),z=q.exports},3811:function(t,e,r){r.d(e,{EF:function(){return l},Te:function(){return c},WD:function(){return u},ij:function(){return o},mm:function(){return i},pk:function(){return f},rt:function(){return n},wR:function(){return s}});var a=r(9312);function s(){return(0,a.U2)("getBaseContract",{})}function n(t,e){return(0,a.U2)(`selectContract/${t}`,e)}function i(t){return(0,a.v_)("writeRentContract",t)}function o(t){return(0,a.cd)("writeRentSign",t)}function l(t){return(0,a.U2)("changeContractStateByUserId",t)}function c(t){return(0,a.v_)("writeWorkContract",t)}function u(t){return(0,a.cd)("writeWorkSign",t)}function f(t){return(0,a.U2)("getContractByUserId",t)}},730:function(t,e,r){r.d(e,{DI:function(){return n},L9:function(){return h},Ow:function(){return u},RD:function(){return l},Rg:function(){return m},Xd:function(){return o},cY:function(){return s},nA:function(){return v},pe:function(){return p},r_:function(){return f},uc:function(){return c},ul:function(){return d},v$:function(){return i}});var a=r(9312);function s(){return(0,a.U2)("/getRole",{})}function n(t){return(0,a.U2)(`/getAllRole/${t}`,{})}function i(t){return(0,a.U2)(`/selectPermsByRoleId/${t}`,{})}function o(t){return(0,a.U2)(`/selectElsePermsByRoleId/${t}`,{})}function l(t){return(0,a.v_)("/updatePermsByRoleId",t)}function c(t){return(0,a.v_)("deletePermsByRoleId",t)}function u(t,e){return(0,a.U2)(`/changeRoleState/${t}`,e)}function f(t){return(0,a.v_)("/insertRole",t)}function d(t){return(0,a.v_)("/updateRole",t)}function p(t){return(0,a.U2)("getRoleSalary",t)}function h(t){return(0,a.U2)("getUserSalary",t)}function v(t){return(0,a.U2)("leaveRole",t)}function m(t){return(0,a.U2)("getUserRole",t)}},4828:function(t,e,r){r.d(e,{Cd:function(){return c},MS:function(){return f},S2:function(){return l},XH:function(){return o},aP:function(){return u},oR:function(){return p},qY:function(){return i},tA:function(){return n},wO:function(){return s},yg:function(){return d}});var a=r(9312);function s(t){return(0,a.U2)(`getAllSalary/${t}`,{})}function n(t){return(0,a.v_)("insertSalary",t)}function i(t){return(0,a.v_)("updateSalary",t)}function o(t){return(0,a.U2)("deleteSalary",t)}function l(t){return(0,a.U2)("getSalaryMap",t)}function c(t,e){return(0,a.U2)(`selectSalaryPay/${t}`,e)}function u(t){return(0,a.Ab)("generateStaffExcel",t)}function f(){return(0,a.Ab)("generateStaffSalary",{})}function d(){return(0,a.U2)("judgeGenerateStaff",{})}function p(t){return(0,a.U2)("getUserSalaryByUserId",t)}}}]);
//# sourceMappingURL=814.3dddaccd.js.map